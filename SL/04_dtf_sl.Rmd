# Data Tables and Figures {#dtf .unnumbered}

```{r}
# load libraries
library(knitr)
library(kableExtra)
library(readr)
library(googlesheets4)
library(lubridate)
library(here)
library(purrr)
library(glue)
library(gt)
library(tibble)
library(forcats)
library(ggplot2)
library(ggthemes)
library(RColorBrewer)
library(scales)
library(dplyr)
library(getable)
gs4_deauth()
```

## Test Selection Procedures

Neuropsychological tests are intrinsically performance-based, and cognitive performance assessed during this neuropsychological evaluation is summarized below.
Where appropriate, qualitative observations are included.
Cultural considerations were made when selecting measures, interpreting results, and making diagnostic impressions and recommendations.
Results from formal tests are reported in comparison to other individuals the same age, sex, and educational level as range of functioning (e.g., superior, average, abnormal).
Test score labels are intended solely to be descriptive, identifying positions of scores relative to a normal curve distribution, and should be interpreted within the context of the patient's individual presentation and history.
Although standardized scores provide the clinician with an important and necessary understanding of the patient's test performance compared with a normative group, they do not on their own lead to accurate diagnosis or treatment recommendations.

```{r results="asis"}
cat("
<style>
table {
      table-layout: auto;
      width: 100%;
      color: black;
      font-size: 12px;
      font-family: 'Roboto Condensed', 'Metrophobic', 'Aldrich';
      break-inside: avoid;
    }
</style>
")
```

```{r results="asis"}
cat("
<style>
caption {
      color: black;
      font-weight: bold;
      font-size: 14px;
      font-family: 'Roboto Condensed', 'Metrophobic', 'Aldrich';
    }
</style>
")
```

| Score range        | Standard score | *T* score | Scaled score |  *z*-score   | Percentile (‰) |
|:-------------------|:--------------:|:---------:|:------------:|:------------:|:--------------:|
| Exceptionally High |     ≧ 130      |   70 +    |     16 +     |     2 +      |      ≧ 98      |
| Above Average      |   120 -- 129   | 63 -- 69  |   14 -- 15   |  1.3 -- 1.9  |    91 -- 97    |
| High Average       |   110 -- 119   | 57 -- 62  |   12 -- 13   |  0.7 -- 1.2  |    75 -- 90    |
| Average            |   90 -- 109    | 44 -- 56  |   9 -- 11    | -0.7 -- 0.6  |    25 -- 74    |
| Low Average        |    80 -- 89    | 37 -- 43  |    7 -- 8    | -1.3 -- -0.6 |    9 -- 24     |
| Below Average      |    70 -- 79    | 30 -- 36  |    4 -- 6    |  -2 -- -1.4  |     2 -- 8     |
| Exceptionally Low  |     \< 70      |   \< 30   |     \< 4     |    \< -2     |      \< 2      |

: Test Score Labels/Ranges

```{r narrow-broad, fig.show = "hold", fig.align = "center", fig.cap = "Statistical (`top`) and clinical (`bottom`) interpretation of test scores", out.width = "85%"}
knitr::include_graphics(here::here("04_DTF", "plot_narrow.png"), auto_pdf = TRUE)
knitr::include_graphics(here::here("04_DTF", "plot_broad.png"), auto_pdf = TRUE)
```

## Neurocognitive Measures

```{r results="asis"}
cat("
<style>
table {
      table-layout: auto;
      width: 100%;
      color: black;
      font-size: 10px;
      font-family: 'Roboto Condensed', 'Metrophobic', 'Aldrich';
      break-inside: avoid;
    }
</style>
")
```

```{r results="asis"}
cat("
<style>
caption {
      color: black;
      font-weight: bold;
      font-size: 12px;
      font-family: 'Roboto Condensed', 'Metrophobic', 'Aldrich';
    }
</style>
")
```

```{r, iq, eval=TRUE}
## Make data frame
iq <- neurocog %>%
  arrange(absort) %>%
  filter(domain == "Intelligence") %>%
  select("scale", "score", "percentile", "range", "subdomain") %>%
  mutate(percentile = round(percentile, digits = 0)) %>%
  purrr::set_names(c("Scale", "Score", "‰ Rank", "Range", "Subdomain"))

## Make table
iq_tbl <-
  kbl(iq, caption = "(ref:iq)", "html", longtable = TRUE, booktabs = TRUE, linesep = "", align = c("lcccl")) %>%
  kableExtra::kable_styling(.) %>%
  row_spec(0, bold = TRUE) %>%
  kableExtra::add_footnote(c("Score = Standard/Composite score (M = 100, SD = 15)"), notation = "alphabet") %>% 
  pack_rows("WISC-5", 1, 4, label_row_css = "background-color: #666; color: #fff;")
iq_tbl

```

\

```{r, academics, eval=TRUE}
## Make data frame
academics <- neurocog %>%
  arrange(absort) %>%
  filter(domain == "Academic Skills") %>%
  select("scale", "score", "percentile", "range", "subdomain") %>%
  mutate(percentile = round(percentile, digits = 0)) %>%
  set_names(c("Scale", "Score", "‰ Rank", "Range", "Subdomain"))

# Make table
academics_tbl <-
  kbl(academics, caption = "(ref:academics)", "html", longtable = TRUE, booktabs = TRUE, linesep = "", align = c("lcccl")) %>%
  kableExtra::kable_styling(.) %>%
  row_spec(0, bold = TRUE) %>%
  kableExtra::add_footnote(c("Score = Standard/Composite score (M = 100, SD = 15)"), notation = "alphabet") %>%
  pack_rows("KTEA-3", 1, 5, label_row_css = "background-color: #666; color: #fff;") %>%
  pack_rows("WRAT-5", 6, 10, label_row_css = "background-color: #666; color: #fff;")
academics_tbl

```

\

```{r, verbal, eval=TRUE}

## Make data frame
verbal <- neurocog %>%
  arrange(absort) %>%
  filter(domain == "Verbal/Language") %>%
  select("scale", "score", "percentile", "range", "subdomain") %>%
  mutate(percentile = round(percentile, digits = 0)) %>%
  purrr::set_names(c("Scale", "Score", "‰ Rank", "Range", "Subdomain"))

# Make table
verbal_tbl <-
  kbl(verbal, caption = "(ref:verbal)", "html", longtable = TRUE, booktabs = TRUE, linesep = "", align = c("lcccl")) %>%
  kableExtra::kable_styling(.) %>%
  row_spec(0, bold = TRUE) %>%
  kableExtra::add_footnote(c("Score = Scaled score (M = 10, SD = 3)"), notation = "alphabet") %>% 
  pack_rows("NEPSY-2", 1, 5, label_row_css = "background-color: #666; color: #fff;") %>%
  pack_rows("WISC-5", 6, 7, label_row_css = "background-color: #666; color: #fff;")
verbal_tbl

```

\

```{r, spatial, eval=TRUE}

## Make data frame
spatial <- neurocog %>%
  arrange(absort) %>%
  filter(domain == "Visual Perception/Construction") %>%
  select("scale", "score", "percentile", "range", "subdomain") %>%
  mutate(percentile = round(percentile, digits = 0)) %>%
  set_names(c("Scale", "Score", "‰ Rank", "Range", "Subdomain"))

# Make table
spatial_tbl <-
  kbl(spatial, caption = "(ref:spatial)", "html", longtable = TRUE, booktabs = TRUE, linesep = "", align = c("lcccl")) %>%
  kableExtra::kable_styling(.) %>%
  row_spec(0, bold = TRUE) %>%
  kableExtra::add_footnote(c("Score = Scaled score (M = 10, SD = 3)"), notation = "alphabet") %>%
  pack_rows("NEPSY-2", 1, 2, label_row_css = "background-color: #666; color: #fff;") %>% 
  pack_rows("WISC-5", 3, 6, label_row_css = "background-color: #666; color: #fff;")
spatial_tbl

```

\

```{r, executive, eval=TRUE}

## Make data frame
executive <- neurocog %>%
  arrange(absort) %>%
  filter(domain == "Attention/Executive") %>%
  select("scale", "score", "percentile", "range", "subdomain") %>%
  mutate(percentile = round(percentile, digits = 0)) %>%
  purrr::set_names(c("Scale", "Score", "‰ Rank", "Range", "Subdomain"))

# Make table
executive_tbl <-
  kbl(executive, caption = "(ref:executive)", "html", longtable = TRUE, booktabs = TRUE, linesep = "", align = c("lcccl")) %>%
  kableExtra::kable_styling(.) %>%
  row_spec(0, bold = TRUE) %>%
  kableExtra::add_footnote(c("Score = *T* score (M = 50, SD = 10) or Scaled score (M = 10, SD = 3)"), notation = "alphabet") %>%
  pack_rows("NIH EXAMINER", 1, 4, label_row_css = "background-color: #666; color: #fff;") %>% 
  pack_rows("NEPSY-2", 5, 9, label_row_css = "background-color: #666; color: #fff;") %>% 
  pack_rows("WISC-5", 10, 11, label_row_css = "background-color: #666; color: #fff;")
executive_tbl

```

\

```{r, memory, eval=TRUE}
## Make data frame
memory <- neurocog %>%
  arrange(absort) %>%
  filter(domain == "Memory") %>%
  select("scale", "score", "percentile", "range", "subdomain") %>%
  mutate(percentile = round(percentile, digits = 0)) %>%
  set_names(c("Scale", "Score", "‰ Rank", "Range", "Subdomain"))

# Make table
memory_tbl <-
  kbl(memory, caption = "(ref:memory)", "html", longtable = TRUE, booktabs = TRUE, linesep = "", align = c("lcccl")) %>%
  kableExtra::kable_styling(.) %>%
  row_spec(0, bold = TRUE) %>%
  kableExtra::add_footnote(c("Score = Scaled score (M = 10, SD = 3)"), notation = "alphabet") %>%
  pack_rows("NEPSY-2", 1, 5, label_row_css = "background-color: #666; color: #fff;")
memory_tbl

```

\

```{r, motor, eval=TRUE}
## Make data frame
motor <- 
  neurocog %>%
  arrange(absort) %>%
  filter(domain == "Motor") %>%
  select("scale", "score", "percentile", "range", "subdomain") %>%
  mutate(percentile = round(percentile, digits = 1)) %>%
  set_names(c("Scale", "Score", "‰ Rank", "Range", "Subdomain"))

# Make table
motor_tbl <-
  kbl(motor, caption = "(ref:motor)", "html", longtable = TRUE, booktabs = TRUE, linesep = "", align = c("lcccl")) %>%
  kableExtra::kable_styling(.) %>%
  row_spec(0, bold = TRUE) %>%
  kableExtra::add_footnote(c("Score = *T* score (M = 50, SD = 10) or Scaled score (M = 10, SD = 3)"), notation = "alphabet") %>%
  pack_rows("Grooved Pegboard", 1, 2, label_row_css = "background-color: #666; color: #fff;") %>% 
  pack_rows("NEPSY-2", 3, 7, label_row_css = "background-color: #666; color: #fff;")
motor_tbl

```

## Behavioral Measures

```{r brown-parent, eval=TRUE}
# Brown EF/A Parent
# make data frame
brown_parent <- 
  neurocog %>%
  arrange(absort) %>%
  filter(test == "brown_parent") %>%
  select("scale", "score", "percentile", "range") %>%
  mutate(percentile = round(percentile, digits = 0)) %>%
  set_names(c("Scale", "Score", "‰ Rank", "Range"))

brown_parent_tbl <-
  kbl(brown_parent, caption = "(ref:brown-parent)", "html", longtable = TRUE, booktabs = TRUE, linesep = "", align = c("lccc")) %>%
  kableExtra::kable_styling(.) %>%
  row_spec(0, bold = TRUE) %>%
  kableExtra::add_footnote(c("Score = *T* score (M = 50, SD = 10)"), notation = "alphabet") 
brown_parent_tbl

```

```{r basc3-prs-child, eval=TRUE}
# BASC-3 PRS Child
# make data frame
basc3_prs_child <- neurocog %>%
  arrange(absort) %>%
  filter(test == "basc3_prs_child") %>%
  select("scale", "score", "percentile", "range") %>%
  mutate(percentile = round(percentile, digits = 0)) %>%
  set_names(c("Scale", "Score", "‰ Rank", "Range"))

basc3_prs_child_tbl <-
  kbl(basc3_prs_child, caption = "(ref:basc3-prs-child)", "html", longtable = TRUE, booktabs = TRUE, linesep = "", align = c("lccc")) %>%
  kableExtra::kable_styling(.) %>%
  row_spec(0, bold = TRUE) %>%
  # row_spec(c(1, 5, 9, 13), bold = TRUE) %>%
  # add_indent(c(2:4, 6:8, 10:12, 14:18)) %>%
  kableExtra::add_footnote(c("Score = *T* score (M = 50, SD = 10))\nNote: *T* scores are reversed for the Adaptive Skills measures."), notation = "alphabet") %>% 
  pack_rows("Composite Score Summary", 1, 4, label_row_css = "background-color: #666; color: #fff;") %>% 
  pack_rows("Scale Score Summary", 5, 18, label_row_css = "background-color: #666; color: #fff;")

basc3_prs_child_tbl

```

\

```{r basc3-srp-child, eval=TRUE}
# BASC-3 SRP Child
# make data frame
basc3_srp_child <- 
  neurocog %>%
  arrange(absort) %>%
  filter(test == "basc3_srp_child") %>%
  select("scale", "score", "percentile", "range") %>%
  mutate(percentile = round(percentile, digits = 0)) %>%
  set_names(c("Scale", "Score", "‰ Rank", "Range"))

basc3_srp_child_tbl <-
  kbl(basc3_srp_child, caption = "(ref:basc3-srp-child)", "html", longtable = TRUE, booktabs = TRUE, linesep = "", align = c("lccc")) %>%
  kableExtra::kable_styling(.) %>%
  row_spec(0, bold = TRUE) %>%
  # row_spec(c(1, 4, 11, 14, 19, 20), bold = TRUE) %>%
  # add_indent(c(2:3, 5:10, 12:13, 15:18)) %>%
  kableExtra::add_footnote(c("Score = *T* score (M = 50, SD = 10))\nNote: *T* scores are reversed for the Adaptive Skills measures."), notation = "alphabet") %>% 
  pack_rows("Composite Score Summary", 1, 5, label_row_css = "background-color: #666; color: #fff;") %>% 
  pack_rows("Scale Score Summary", 6, 19, label_row_css = "background-color: #666; color: #fff;")
basc3_srp_child_tbl

```

\

### References
